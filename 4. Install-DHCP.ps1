#Define desired configuration$DNSservers = "192.168.1.101"$Gateway = "192.168.1.254"$scopeipstartrange = "192.168.1.140"$scopeipendrange = "192.168.1.199"$scopesubnetmask = "255.255.255.0"#Get the computer name$NewComputerName = (Get-WmiObject -Class Win32_ComputerSystem).name#Install DHCP RoleInstall-WindowsFeature DHCP -IncludeManagementTools#Create DHCP Scope$scopename = $NewComputerName + "-scope"$scopedescription = "Scope for " + $NewComputerNameAdd-DhcpServerv4Scope -ComputerName $NewComputerName -Name $scopename -StartRange $scopeipstartrange -EndRange $scopeipendrange -Description $scopedescription -Type DHCP -State Active -SubnetMask $scopesubnetmask -LeaseDuration (New-TimeSpan -Days 1)#Set DNS Server Scope optionSet-DhcpServerv4OptionValue -OptionId 6 -Value $DNSServers#Set Router Scope option (gateway)Set-DhcpServerv4OptionValue -OptionId 3 -Value $Gateway#Authorize the DHCP Server in Active Directory$DnsHostname = (Get-WmiObject win32_computersystem).DnsHostnameAdd-DhcpServerInDC -DnsName $DnsHostname