#Define desired new configuration.$NewComputerName = "DC-01"$IPAddress = "192.168.1.101"$SubnetMask = "255.255.255.0"$DefaultGateway = "192.168.1.254"$DNSServers = $IPAddress#At first only enable the NIC you want to configure if you're using multiple NICs.#Otherwise filter in another way so that only the NIC you desire will be affected.$NICs = Get-WmiObject Win32_NetworkAdapterConfiguration | Where {$_.IPEnabled -eq "TRUE"}Foreach($NIC in $NICs){    $NIC.EnableStatic($IPAddress,$SubnetMask)    $NIC.SetGateways($DefaultGateway)    $NIC.SetDNSServerSearchOrder($DNSServers)}#Rename the computer$ComputerInfo = Get-WmiObject -Class Win32_ComputerSystem$ComputerInfo.rename($NewComputerName)#Reboot Computer to activate the new nameRestart-Computer -force